<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÜ Bol√£o Piauiz√£o Oficial</title>
    <style>
        :root {
            --primary: #00703c;
            /* Verde Piau√≠ */
            --secondary: #fdb913;
            /* Amarelo Piau√≠ */
            --dark: #1a1a1a;
            --light: #f4f4f4;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --accent: #e74c3c;
            --purple: #9b59b6;
            --blue: #3498db;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            padding-bottom: 50px;
        }

        header {
            background: linear-gradient(135deg, var(--primary), #004d2a);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            box-shadow: var(--shadow);
            position: relative;
        }

        header h1 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .admin-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .admin-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .container {
            max-width: 1100px;
            margin: 20px auto;
            padding: 0 15px;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
        }

        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
        }

        .nav-rodadas {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .nav-rodadas button {
            padding: 8px 15px;
            border: none;
            background: var(--white);
            border-radius: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            font-weight: bold;
            transition: 0.3s;
        }

        .nav-rodadas button.active {
            background: var(--primary);
            color: white;
        }

        .section-title {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
            border-bottom: 3px solid var(--secondary);
            padding-bottom: 5px;
            width: fit-content;
        }

        .game-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border-left: 6px solid var(--primary);
            position: relative;
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            font-weight: bold;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #666;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .match-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
            font-weight: bold;
            font-size: 1.1rem;
            text-align: center;
        }

        .score-input-container {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
            border: 1px dashed var(--primary);
        }

        .official-score {
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
        }

        .official-score input {
            width: 45px;
            height: 35px;
            text-align: center;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 5px;
        }

        .guesses-list {
            max-height: 180px;
            overflow-y: auto;
            background: #fafafa;
            padding: 10px;
            border-radius: 8px;
        }

        .guess-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 10px;
            border-radius: 6px;
            margin-bottom: 4px;
            font-size: 0.85rem;
            background: #fff;
            border: 1px solid #eee;
        }

        .guess-item.winner {
            background-color: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .guess-item.draw {
            background-color: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .ranking-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 20px;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
        }

        .ranking-table th {
            text-align: left;
            padding: 10px;
            background: var(--primary);
            color: white;
            font-size: 0.8rem;
        }

        .ranking-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .badge-pts {
            background: var(--secondary);
            color: var(--dark);
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: bold;
        }

        #admin-panel {
            display: none;
            background: #fff;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border: 2px solid var(--primary);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .btn-add {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .btn-export {
            background: var(--blue);
            margin-bottom: 5px;
        }

        .btn-import {
            background: #2ecc71;
            margin-bottom: 5px;
        }

        .btn-reset {
            background: #e67e22;
            margin-bottom: 5px;
        }

        .btn-password {
            background: var(--purple);
            margin-bottom: 5px;
        }

        .btn-close-admin {
            background: #666;
        }

        .help-text {
            font-size: 0.7rem;
            color: #777;
            margin-top: 3px;
        }

        .empty-msg {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: var(--radius);
            color: #888;
        }

        .data-export-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border: 2px dashed #ccc;
        }

        .data-textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.8rem;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>

    <header>
        <button class="admin-btn" onclick="window.toggleAdmin()">‚öôÔ∏è Gerenciar</button>
        <h1>üèÜ Bol√£o Piauiz√£o</h1>
        <p>Campeonato Piauiense 2026</p>
    </header>

    <div class="container">
        <main>
            <section id="admin-panel">
                <h3 class="section-title">üÜï Novo Jogo + Palpites</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>Rodada</label>
                        <input type="number" id="new-rodada" value="2">
                    </div>
                    <div class="form-group">
                        <label>Est√°dio</label>
                        <input type="text" id="new-stadium" placeholder="Ex: Gerson Campos">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>Time A</label>
                        <input type="text" id="new-teamA" placeholder="Ex: River">
                    </div>
                    <div class="form-group">
                        <label>Time B</label>
                        <input type="text" id="new-teamB" placeholder="Ex: Altos">
                    </div>
                </div>
                <div class="form-group">
                    <label>Data e Hora</label>
                    <input type="text" id="new-date" placeholder="Ex: 17/01/2026 ‚Äì 16:00">
                </div>
                <div class="form-group">
                    <label>Colar Palpites (Um por linha)</label>
                    <textarea id="new-palpites" rows="5" placeholder="1x2 Nome do Participante"></textarea>
                    <p class="help-text">Formato esperado: 1x2 Jo√£o Silva</p>
                </div>

                <button class="btn-add" onclick="window.addNewGame()">Salvar Jogo e Palpites</button>

                <div class="data-export-section">
                    <h4>üìÅ Gerenciar Dados</h4>
                    <p class="help-text">Exporte os dados para salvar em outro dispositivo:</p>
                    <textarea class="data-textarea" id="export-data" readonly></textarea>
                    <button class="btn-add btn-export" onclick="window.exportData()">üìã Copiar Dados</button>
                    <button class="btn-add btn-import" onclick="window.importData()">üì• Importar Dados</button>
                </div>

                <button class="btn-add btn-reset" onclick="window.resetData()">üîÑ Resetar para o Padr√£o</button>
                <button class="btn-add btn-password" onclick="window.changeAdminPassword()">üîê Alterar Senha do
                    Administrador</button>
                <button class="btn-add btn-close-admin" onclick="window.toggleAdmin()">Fechar Painel</button>
            </section>

            <div class="nav-rodadas" id="rodadas-nav"></div>
            <div id="games-container"></div>
        </main>

        <aside>
            <div class="ranking-card">
                <h2 class="section-title">üìä Classifica√ß√£o Geral</h2>
                <table class="ranking-table">
                    <thead>
                        <tr>
                            <th>Pos</th>
                            <th>Nome</th>
                            <th>Pts</th>
                        </tr>
                    </thead>
                    <tbody id="ranking-body"></tbody>
                </table>
                <div style="font-size: 0.7rem; color: #888; margin-top: 15px;">
                    <p><strong>Regras de Pontua√ß√£o:</strong></p>
                    <p>* 3 pts: Acertar o vencedor (independente do placar)</p>
                    <p>* 1 pt: Acertar o empate (independente do placar)</p>
                    <p>* 0 pts: Errar o resultado do jogo</p>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // --- DADOS INICIAIS ---
        const INITIAL_DATA = [{
                id: 1,
                rodada: 2,
                teamA: "Oeirense",
                teamB: "Atl√©tico Piauiense",
                stadium: "Gerson Campos",
                date: "17/01/2026 ‚Äì 16:00",
                resultA: null,
                resultB: null,
                palpites: [{
                        user: "Allef Carvalho",
                        pA: 1,
                        pB: 2
                    },
                    {
                        user: "Yan Gabriel",
                        pA: 1,
                        pB: 2
                    },
                    {
                        user: "Mar√≠lia Gabriela",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Jo√£o Emanuel",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Fl√°vio",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Alex Randec",
                        pA: 0,
                        pB: 4
                    },
                    {
                        user: "Alberto",
                        pA: 1,
                        pB: 3
                    },
                    {
                        user: "Diniz Monitoramento",
                        pA: 0,
                        pB: 1
                    },
                    {
                        user: "Jorge",
                        pA: 0,
                        pB: 1
                    },
                    {
                        user: "Hudson",
                        pA: 2,
                        pB: 1
                    },
                    {
                        user: "JP",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Airton Costa",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Marcos Vinicius",
                        pA: 1,
                        pB: 3
                    },
                    {
                        user: "Leandro",
                        pA: 1,
                        pB: 2
                    },
                    {
                        user: "Erinan",
                        pA: 0,
                        pB: 0
                    }
                ]
            },
            {
                id: 2,
                rodada: 2,
                teamA: "Fluminense",
                teamB: "Piau√≠",
                stadium: "Albert√£o",
                date: "17/01/2026 ‚Äì 17:00",
                resultA: null,
                resultB: null,
                palpites: [{
                        user: "Allef Carvalho",
                        pA: 2,
                        pB: 1
                    },
                    {
                        user: "Yan Gabriel",
                        pA: 2,
                        pB: 0
                    },
                    {
                        user: "Mar√≠lia Gabriela",
                        pA: 1,
                        pB: 0
                    },
                    {
                        user: "Jo√£o Emanuel",
                        pA: 2,
                        pB: 1
                    },
                    {
                        user: "Hudson",
                        pA: 1,
                        pB: 1
                    },
                    {
                        user: "JP",
                        pA: 3,
                        pB: 0
                    }
                ]
            },
            {
                id: 3,
                rodada: 2,
                teamA: "Teresina",
                teamB: "Altos",
                stadium: "Albert√£o",
                date: "18/01/2026 ‚Äì 17:00",
                resultA: null,
                resultB: null,
                palpites: [{
                        user: "Allef Carvalho",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Alex Randec",
                        pA: 1,
                        pB: 3
                    },
                    {
                        user: "Fl√°vio",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Jorge",
                        pA: 0,
                        pB: 1
                    }
                ]
            },
            {
                id: 4,
                rodada: 2,
                teamA: "Corissab√°",
                teamB: "Parnahyba",
                stadium: "Tib√©rio Nunes",
                date: "18/01/2026 ‚Äì 18:00",
                resultA: null,
                resultB: null,
                palpites: [{
                        user: "Allef Carvalho",
                        pA: 1,
                        pB: 1
                    },
                    {
                        user: "Yan Gabriel",
                        pA: 0,
                        pB: 2
                    },
                    {
                        user: "Marcos Vinicius",
                        pA: 1,
                        pB: 2
                    }
                ]
            }
        ];

        // --- VARI√ÅVEIS GLOBAIS ---
        let matches = [];
        let rodadaAtiva = 2;
        let adminMode = false;
        const DEFAULT_ADMIN_PASSWORD = "admin123"; // Senha padr√£o

        // --- INICIALIZA√á√ÉO ---
        function init() {
            // Sempre come√ßa com os dados iniciais
            matches = [...INITIAL_DATA];
            renderAll();
        }

        // --- C√ÅLCULO DE PONTOS ---
        function calculatePoints(guess, official) {
            if (official.pA === null || official.pB === null) return 0;
            const gA = parseInt(guess.pA);
            const gB = parseInt(guess.pB);
            const oA = parseInt(official.pA);
            const oB = parseInt(official.pB);

            const vitoriaA = oA > oB;
            const vitoriaB = oB > oA;
            const empate = oA === oB;

            const palpiteA = gA > gB;
            const palpiteB = gB > gA;
            const palpiteEmpate = gA === gB;

            if (vitoriaA && palpiteA) return 3;
            if (vitoriaB && palpiteB) return 3;
            if (empate && palpiteEmpate) return 1;

            return 0;
        }

        // --- FUN√á√ïES GLOBAIS ---
        window.toggleAdmin = function () {
            const panel = document.getElementById('admin-panel');

            if (adminMode) {
                adminMode = false;
                panel.style.display = 'none';
            } else {
                const pass = prompt("Digite a senha de administrador (padr√£o: admin123):");
                if (pass === DEFAULT_ADMIN_PASSWORD) {
                    adminMode = true;
                    panel.style.display = 'block';
                    // Atualizar √°rea de exporta√ß√£o
                    document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
                } else {
                    if (pass !== null) alert("Senha incorreta!");
                }
            }
            renderAll();
        };

        window.changeAdminPassword = function () {
            alert("Para alterar a senha, edite a vari√°vel DEFAULT_ADMIN_PASSWORD no c√≥digo fonte.");
        };

        window.setRodada = function (r) {
            rodadaAtiva = r;
            renderAll();
        };

        window.updateScore = function (gameId, side, val) {
            const game = matches.find(m => m.id === Number(gameId));
            if (!game) return;
            const num = val === "" ? null : parseInt(val);
            if (side === 'A') game.resultA = num;
            else game.resultB = num;
            renderAll();
            // Atualizar dados de exporta√ß√£o
            document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
        };

        window.deleteGame = function (id) {
            if (confirm("Excluir este jogo permanentemente?")) {
                matches = matches.filter(m => m.id !== Number(id));
                renderAll();
                // Atualizar dados de exporta√ß√£o
                document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
            }
        };

        window.resetData = function () {
            if (confirm("Resetar todos os dados para os valores padr√£o?")) {
                matches = [...INITIAL_DATA];
                rodadaAtiva = 2;
                renderAll();
                document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
                alert("Dados resetados para o padr√£o!");
            }
        };

        window.addNewGame = function () {
            const teamA = document.getElementById('new-teamA').value.trim();
            const teamB = document.getElementById('new-teamB').value.trim();
            const stadium = document.getElementById('new-stadium').value.trim() || "Est√°dio";
            const date = document.getElementById('new-date').value.trim() || "A definir";
            const rodada = parseInt(document.getElementById('new-rodada').value) || 1;
            const palpitesText = document.getElementById('new-palpites').value;

            if (!teamA || !teamB) return alert("Informe os times!");

            const newGame = {
                id: Date.now(),
                rodada,
                teamA,
                teamB,
                stadium,
                date,
                resultA: null,
                resultB: null,
                palpites: parsePalpites(palpitesText)
            };

            matches.push(newGame);
            rodadaAtiva = rodada;

            // Limpar formul√°rio
            document.getElementById('new-teamA').value = '';
            document.getElementById('new-teamB').value = '';
            document.getElementById('new-palpites').value = '';

            renderAll();
            document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
            alert("Jogo adicionado!");
        };

        window.exportData = function () {
            const exportData = JSON.stringify(matches, null, 2);
            navigator.clipboard.writeText(exportData).then(() => {
                alert(
                    "Dados copiados para a √°rea de transfer√™ncia! Cole em um arquivo de texto para salvar."
                    );
            }).catch(err => {
                console.error('Erro ao copiar:', err);
                alert("Copie manualmente o texto acima para salvar os dados.");
            });
        };

        window.importData = function () {
            const dataStr = prompt("Cole os dados JSON aqui:");
            if (!dataStr) return;

            try {
                const importedData = JSON.parse(dataStr);
                if (!Array.isArray(importedData)) {
                    throw new Error("Dados inv√°lidos");
                }

                // Validar estrutura b√°sica
                const isValid = importedData.every(item =>
                    item.id && item.teamA && item.teamB && Array.isArray(item.palpites)
                );

                if (!isValid) {
                    throw new Error("Estrutura de dados inv√°lida");
                }

                matches = importedData;
                renderAll();
                document.getElementById('export-data').value = JSON.stringify(matches, null, 2);
                alert("Dados importados com sucesso!");
            } catch (error) {
                alert("Erro ao importar dados. Verifique o formato JSON.");
                console.error(error);
            }
        };

        function parsePalpites(text) {
            if (!text) return [];
            return text.split('\n').filter(l => l.trim()).map(line => {
                const match = line.match(/(\d+)\s*[xX-]\s*(\d+)\s*(.*)/);
                if (match) return {
                    pA: parseInt(match[1]),
                    pB: parseInt(match[2]),
                    user: match[3].trim()
                };
                return null;
            }).filter(p => p !== null);
        }

        // --- RENDERIZA√á√ÉO ---
        function renderAll() {
            renderNav();
            renderGames();
            renderRanking();
        }

        function renderNav() {
            const nav = document.getElementById('rodadas-nav');
            const rodadas = [...new Set(matches.map(m => m.rodada))].sort((a, b) => a - b);

            if (rodadas.length === 0 && matches.length > 0) {
                nav.innerHTML = '';
                return;
            }

            nav.innerHTML = rodadas.map(r => `
                <button class="${r === rodadaAtiva ? 'active' : ''}" onclick="window.setRodada(${r})">
                    Rodada ${r.toString().padStart(2, '0')}
                </button>
            `).join('');
        }

        function renderGames() {
            const container = document.getElementById('games-container');
            const filtered = matches.filter(m => m.rodada === rodadaAtiva);

            if (filtered.length === 0) {
                container.innerHTML = `<div class="empty-msg">Sem jogos nesta rodada.</div>`;
                return;
            }

            container.innerHTML = filtered.map(game => {
                const palpitesHtml = game.palpites.map(p => {
                    const pts = calculatePoints(p, {
                        pA: game.resultA,
                        pB: game.resultB
                    });
                    const cls = pts === 3 ? 'winner' : (pts === 1 ? 'draw' : '');
                    const badge = pts > 0 ? `<span class="badge-pts">+${pts}</span>` : '';
                    return `
                        <div class="guess-item ${cls}">
                            <span>${p.pA} x ${p.pB} ‚Äî <strong>${p.user}</strong></span>
                            ${badge}
                        </div>
                    `;
                }).join('');

                return `
                    <div class="game-card">
                        <button class="delete-btn" style="display:${adminMode ? 'block' : 'none'}" onclick="window.deleteGame(${game.id})">√ó</button>
                        <div class="game-header">
                            <span>üèüÔ∏è ${game.stadium}</span>
                            <span>üìÖ ${game.date}</span>
                        </div>
                        <div class="match-display">
                            <div style="flex:1">${game.teamA}</div>
                            <div style="color:var(--primary); font-size:0.8rem">VS</div>
                            <div style="flex:1">${game.teamB}</div>
                        </div>
                        <div class="score-input-container">
                            <div class="official-score">
                                <input type="number" value="${game.resultA !== null ? game.resultA : ''}" onchange="window.updateScore(${game.id}, 'A', this.value)">
                                <span>x</span>
                                <input type="number" value="${game.resultB !== null ? game.resultB : ''}" onchange="window.updateScore(${game.id}, 'B', this.value)">
                            </div>
                            <small style="color:#888; display:block; margin-top:5px">Placar Oficial</small>
                        </div>
                        <div class="guesses-list">
                            ${palpitesHtml || '<p style="text-align:center; font-size:0.8rem; color:#ccc">Nenhum palpite</p>'}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderRanking() {
            const tbody = document.getElementById('ranking-body');
            const totals = {};

            matches.forEach(game => {
                game.palpites.forEach(p => {
                    if (!totals[p.user]) totals[p.user] = 0;
                    totals[p.user] += calculatePoints(p, {
                        pA: game.resultA,
                        pB: game.resultB
                    });
                });
            });

            const sorted = Object.entries(totals)
                .map(([name, pts]) => ({
                    name,
                    pts
                }))
                .sort((a, b) => b.pts - a.pts);

            if (sorted.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align:center">Nenhum dado</td></tr>';
                return;
            }

            tbody.innerHTML = sorted.map((p, i) => `
                <tr>
                    <td>${i+1}¬∫</td>
                    <td>${p.name}</td>
                    <td><span class="badge-pts">${p.pts}</span></td>
                </tr>
            `).join('');
        }

        window.onload = init;
    </script>
</body>

</html>